{% extends "base.html" %}
{% block title %}Create Bill{% endblock %}
{% block content %}

<style>
/* ðŸŒŸ LIGHT SKY ABSTRACT BACKGROUND */
/* ðŸŒŸ PREMIUM CENTERED SKY BACKGROUND */
body {
  background: radial-gradient(
      circle at center,
      #ffffff 8%,
      #e9f2ff 32%,
      #cfe3ff 60%,
      #b0d3ff 100%
  );
  min-height: 100vh;
  margin: 0;
  overflow-x: hidden;
  position: relative;
}

/* Glow Lights */
body::before,
body::after {
  content: "";
  position: fixed;
  width: 620px;
  height: 620px;
  border-radius: 50%;
  filter: blur(95px);
  z-index: -1;
  opacity: .55;
}
body::before {
  top: -160px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,118,255,.28);
  animation: glowMove 7s infinite alternate ease-in-out;
}
body::after {
  bottom: -160px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,92,255,.25);
  animation: glowMove 9s infinite alternate ease-in-out;
}

@keyframes glowMove {
  from { transform: translateX(-50%) translateY(0); }
  to   { transform: translateX(-50%) translateY(40px); }
}

/* ICON & HEADING */
.bill-icon {
  width: 75px;
  margin: 0 auto 6px;
  display: block;
  filter: drop-shadow(0 3px 12px rgba(0,110,255,.6));
}
.bill-card h2 {
  text-align: center;
  font-size: 29px;
  font-weight: 800;
  color: #0050ff;
  margin-bottom: 24px;
}

/* FIELDS */
.field-row { margin-bottom: 16px; }
.field-label {
  font-size: 14px;
  font-weight: 650;
  color: #0049d6;
  margin-bottom: 4px;
}
.field-input,
.field-select {
  width: 100%;
  padding: 12px 13px;
  border-radius: 12px;
  border: 2px solid rgba(175,200,255,0.95);
  font-size: 15px;
  background: #fff;
  transition: .22s;
}
.field-input:focus,
.field-select:focus {
  border-color: #0076ff;
  box-shadow: 0 0 10px rgba(0,110,255,.45);
  outline: none;
}

/* READONLY */
.readonly-box {
  background: #eaf0ff;
  font-weight: 600;
}

/* BUTTON */
.btn-next {
  width: 230px;
  display: block;
  margin: 25px auto 0;
  padding: 14px 0;
  font-size: 18px;
  font-weight: 800;
  border-radius: 16px;
  border: none;
  cursor: pointer;
  background: linear-gradient(180deg, #0b3ea7, #012261);
  color: #fff;
  box-shadow: 0 0 22px rgba(0,110,255,.55);
  transition: .25s;
}
.btn-next:hover {
  transform: translateY(-4px);
  box-shadow: 0 0 30px rgba(0,110,255,.9);
}
.btn-next:active {
  transform: scale(.97);
}
</style>

<div class="bill-card">
  <img src="https://cdn-icons-png.flaticon.com/512/942/942748.png" class="bill-icon" alt="">
  <h2>Create New Bill</h2>

  <form method="post">
    {% csrf_token %}

    <div class="field-row">
      <div class="field-label">Customer</div>
      <select name="customer_name" id="customer_name" class="field-select">
        <option value="">-- Select Customer --</option>
        {% for c in customers %}
          <option value="{{ c.name }}" data-phone="{{ c.phone }}">{{ c.name }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="field-row">
      <div class="field-label">Mobile</div>
      <input type="text" name="phone" id="phone" class="field-input" maxlength="10"
        oninput="this.value = this.value.replace(/[^0-9]/g,'').slice(0,10);"
        placeholder="Auto filled when customer selected">
    </div>

    <div class="row">
      <div class="col-md-6 field-row">
        <div class="field-label">Date</div>
     <input type="date" name="date" class="field-input"
       value="{{ default_date }}">
      </div>

      <div class="col-md-6 field-row">
        <div class="field-label">Bill No</div>
        <input type="text" class="field-input readonly-box" value="{{ next_bill_no }}" readonly>
      </div>
    </div>

    <button type="submit" class="btn-next">Continue & Add Items</button>
  </form>
</div>

<!-- PHONE AUTO FILL -->
<script>
document.getElementById("customer_name").addEventListener("change", function () {
    let phone = this.options[this.selectedIndex].getAttribute("data-phone");
    document.getElementById("phone").value = phone ? phone : "";
});
</script>

{% endblock %}
